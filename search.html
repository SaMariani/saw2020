<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="codepenStyleForProducts.css">


    <meta name="viewport" content="width=device-width, initial-scale=1" />

</head>
<body data-spy="scroll" data-target="#navbar-example">

<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">

        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-example" aria-expanded="false">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href=index.html>BETO LOGOS</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="navbar-example">

            <ul class="nav navbar-nav navbar-right">

                <li><a href=accedi.html>Accedi</a></li>
                <li><a href="under_costruction.html">Chi siamo</a></li>
                <li><a href="products.html">Prodotti</a></li>
                <li><a href="under_costruction.html">Contatti</a></li>

                <li>
                    <form class="navbar-form navbar-left" role="search" action="search.html" method="GET">
                        <div class="form-group">
                            <input type="text" class="form-control" name="search" placeholder="Search" required>
                        </div>
                        <button type="submit" class="btn btn-info glyphicon glyphicon-search"></button>
                    </form>
                </li>

            </ul>

        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>





<div class="container" style="margin-top: 100px">


    <div class="error" id="infoE"></div>
    <div id="list_grid" class="well well-sm" style="visibility: hidden">
        <strong>Results</strong>
        <div class="btn-group">
            <a href="#" id="list" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-th-list">
            </span>List</a> <a href="#" id="grid" class="btn btn-default btn-sm"><span
                class="glyphicon glyphicon-th"></span>Grid</a>
        </div>
    </div>

    <div id='products' class='row list-group'>

    </div>

</div><!-- / container -->



<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<!-- Latest compiled and minified JavaScript -->
<script src="js/bootstrap.min.js"></script>

<script>
    $(document).ready(function() {
        $('#list').click(function(event){event.preventDefault();$('#products .item').addClass('list-group-item');});
        $('#grid').click(function(event){event.preventDefault();$('#products .item').removeClass('list-group-item');$('#products .item').addClass('grid-group-item');});
    });
</script>

</body>
</html>

<script>
    window.onload = function () {
        var url = document.location.href,
            params = url.split('?')[1].split('&'),
            data = {}, tmp;
        for (var i = 0, l = params.length; i < l; i++) {
            tmp = params[i].split('=');
            data[tmp[0]] = tmp[1];
        }
        //document.getElementById('infoE').innerHTML = data.search;
        var xmlHttp;
        if (window.XMLHttpRequest){
            xmlHttp = new XMLHttpRequest();
        }else {
            xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");<!-- per browser vecchi -->
        }
        //var a = document.getElementById("search").value;
        var a = data.search;

        var infoUtente = "search="+a;

        xmlHttp.onreadystatechange = function () {
            if(xmlHttp.readyState === 4 && xmlHttp.status === 200){ <!-- 0: richiesta non inizializzata; 1: richiesta non stabilita; 2: richiesta inviata; 3: Richiesta in processo; 4: Richiesta ultimata -->

                var myObj = JSON.parse(xmlHttp.responseText);
                //console.log(myObj);
                if(myObj.error!==""&&myObj.error!==undefined){
                    res.innerHTML = "";
                    err.innerHTML = myObj.error;
                }
                else{
                    //window.location.replace("officialhome.php");
                    err.innerHTML = "";
                    res.innerHTML = "";
                    txt="";
                    template="";
                    listgrid.style.visibility='visible';
                    txt += "<table border='1'>"
                    for (x in myObj) {

                        template+="<div id='products' class='row list-group'>"+
                            "<div class='item  col-xs-4 col-lg-4'>"+
                                "<div class='thumbnail'>"+
                                    "<img class='group list-group-image' src='http://placehold.it/400x250/000/fff' alt='' />"+
                                    "<div class='caption'>"+
                                        "<h4 class='group inner list-group-item-heading'>"+
                                        myObj[x].nomeprodotto + "</h4>"+
                                        "<p class='group inner list-group-item-text'>"+
                                        myObj[x].descrizione + "</p>"+
                                        "<div class='row'>"+
                                            "<div class='col-xs-12 col-md-4'>"+
                                                "<p class='lead'>"+
                                                myObj[x].prezzo + " €</p>"+
                                            "</div>"+
                                            "<form"+
                                                myObj.codice+"'>"+
                                                "<div class='col-xs-12 col-md-4'>"+
                                                    "<input type='text' class='product-quantity' name='quantity' value='1' size='2' />"+
                                                "</div>"+
                                                "<div class='col-xs-12 col-md-4'>"+
                                                    "<input type='submit' value='Add to Cart' class='btn-success' onclick='ajax_get()'/>"+
                                                "</div>"+
                                            "</form>"+
                                        "</div>"+
                                    "</div>"+
                                "</div>"+
                            "</div>"
                    }
                    res.innerHTML=template;

                }
            }
        };
        xmlHttp.open("GET", "mulesearch.php?"+infoUtente, true);
        xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded")//Send the proper header information along with the request
        xmlHttp.send();
    }
</script>

<script type="text/javascript">
    var err = document.getElementById("infoE");
    var res = document.getElementById("products");
    var listgrid = document.getElementById("list_grid");

    var x, template = "";
    function ajax_get() {
        var xmlHttp;
        if (window.XMLHttpRequest){
            xmlHttp = new XMLHttpRequest();
        }else {
            xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");<!-- per browser vecchi -->
        }
        //var a = document.getElementById("search").value;

        var infoUtente = "search="+"2";

        xmlHttp.onreadystatechange = function () {
            if(xmlHttp.readyState === 4 && xmlHttp.status === 200){ <!-- 0: richiesta non inizializzata; 1: richiesta non stabilita; 2: richiesta inviata; 3: Richiesta in processo; 4: Richiesta ultimata -->

                var myObj = JSON.parse(xmlHttp.responseText);
                //console.log(myObj);
                if(myObj.error!==""&&myObj.error!==undefined){
                    res.innerHTML = "";
                    err.innerHTML = myObj.error;
                }
                else{
                    //window.location.replace("officialhome.php");
                    err.innerHTML = "";
                    res.innerHTML = "";
                    txt="";
                    template="";
                    listgrid.style.visibility='visible';
                    txt += "<table border='1'>"
                    for (x in myObj) {

                        template+="<div class='item  col-xs-4 col-lg-4'>"+
                                "<div class='thumbnail'>"+
                                    "<img class='group list-group-image' src='http://placehold.it/400x250/000/fff' alt='' />"+
                                    "<div class='caption'>"+
                                        "<h4 class='group inner list-group-item-heading'>"+
                                        myObj[x].nomeprodotto + "</h4>"+
                                        "<p class='group inner list-group-item-text'>"+
                                        myObj[x].descrizione + "</p>"+
                                        "<div class='row'>"+
                                            "<div class='col-xs-12 col-md-4'>"+
                                            "<p class='lead'>"+
                                            myObj[x].prezzo + " €</p>"+
                                            "</div>"+
                                            "<form method='post' action='cart.php?action=add&code="+
                                            myObj[x].codice+">"+
                                                 "<div class='col-xs-12 col-md-4'>"+
                                                    "<input type='text' class='product-quantity' name='quantity' value='1' size='2' />"+
                                                "</div>"+
                                                "<div class='col-xs-12 col-md-4'>"+
                                                    "<input type='submit' value='Add to Cart' class='btn-success' />"+
                                                "</div>"+
                                            "</form>"+
                                        "</div>"+
                                    "</div>"+
                                "</div>"+
                            "</div>";
                    }
                    res.innerHTML=template;

                }
            }
        };
        xmlHttp.open("GET", "mulesearch.php?"+infoUtente, true);
        xmlHttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded")//Send the proper header information along with the request
        xmlHttp.send();
    }
</script>